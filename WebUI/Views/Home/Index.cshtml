@using Common.Enums
@using System.Reflection
@using WebUI.Models
@{
    ViewBag.Title = "Dashboard";
    string currentController = (string)ViewContext.RouteData.Values["controller"];
    string currentAction = (string)ViewContext.RouteData.Values["action"];

    Common.Enums.EnumHelper eh = new Common.Enums.EnumHelper();
}

<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row" id="financeContent">
        <div class="col-lg-3"><div class="ibox float-e-margins"><div class="ibox-title"><div class="ibox-content loader"></div></div></div></div>
        <div class="col-lg-3"><div class="ibox float-e-margins"><div class="ibox-title"><div class="ibox-content loader"></div></div></div></div>
        <div class="col-lg-3"><div class="ibox float-e-margins"><div class="ibox-title"><div class="ibox-content loader"></div></div></div></div>
        <div class="col-lg-3"><div class="ibox float-e-margins"><div class="ibox-title"><div class="ibox-content loader"></div></div></div></div>
    </div>

    <div class="row">
        @*Kolom Operasi*@
        <div class="col-lg-4" id="operationContent"><div class="ibox float-e-margins"><div class="ibox-title"><div class="ibox-content loader"></div></div></div></div>
        
        @*Kolom Investasi*@
        <div class="col-lg-4">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-success pull-right">Mei '17</span>
                    <h5>Investasi</h5>
                </div>
                <div class="ibox-content">
                    <ul class="stat-list">
                        <li>
                            <h2 class="no-margins">Rp. 1.421 Triliun</h2>
                            <small>Realisasi Investasi (vs drawdown)</small>
                            <div class="stat-percent">93.5%</div>
                            <div class="progress progress-mini">
                                <div style="width: 94%;" class="progress-bar"></div>
                            </div>
                        </li>
                        <li>
                            <small>Realisasi Investasi (vs phasing out)</small>
                            <div class="stat-percent">51.9%</div>
                            <div class="progress progress-mini">
                                <div style="width: 52%;" class="progress-bar"></div>
                            </div>
                        </li>
                        <li>
                            <small>Progress Fisik</small>
                            <div class="stat-percent">65.3%</div>
                            <div class="progress progress-mini">
                                <div style="width: 65%;" class="progress-bar"></div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        @*Kolom Top Risk*@
        <div class="col-lg-4">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-success pull-right">
                        @DateTime.Now.ToString("MMM \\'yy")
                    </span>
                    <h5>Top Risiko</h5>
                </div>
                <div class="ibox-content">
                    <div class="form-inline mb-15">
                        <div class="radio">
                            <label>
                                <input type="radio" name="RiskType" value="INHERENT"> Inherent
                            </label>
                        </div>
                        <div class="radio">
                            <label>
                                <input type="radio" name="RiskType" value="RESIDUAL" checked> Residual
                            </label>
                        </div>
                    </div>
                    <div class="risk-matrix" id="risk_table">
                        <div class="loader"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts{
    <script>
        $(document).ready(function (e) {
            $.post("@Url.Action("GetFinanceInfo", currentController)", function (data) {
                $("#financeContent").html(data);
            });
            $.post("@Url.Action("GetOperationInfo", currentController)", function (data) {
                $("#operationContent").html(data);
            });
            GetTopRisk();
        });

        $("input[name=RiskType]").change(function () {
            $("#risk_table").html("<div class='loader'></div>");
            GetTopRisk();
        });

        function GetTopRisk() {
            $.post(
                "@Url.Action("GetTopRisk", "Risk", new { Area = "Risk" })",
                {
                    type: $("input[name=RiskType]:checked").val()
                },
                function (data) {
                    $("#risk_table").html(data);
                }
            );
        }
    </script>
}

@Styles.Render("~/Content/loader");